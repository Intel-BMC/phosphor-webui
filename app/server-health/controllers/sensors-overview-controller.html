<loader loading="loading"></loader>
<div id="sensors" class="sensors">

  <div class="page-content-box toggle-filter">
    <div class="filter-box"><label class="trim-text-small">Filter by Status</label>
    </div>

    <div class="filter-box" ng-repeat="severity in severityList">
      <button class="filter-btn" ng-click="toggleSeverity(severity)"
        ng-class="(selectedSeverity == (severity | lowercase)) ? 'btn-filter-primary' : 'btn-filter-secondary'">
        <span class="alert-text-{{severity | lowercase}}">&#9679;</span>&nbsp;{{severity}}
      </button>
    </div>
  </div>

  <div class="page-content-box">
    <div class="columns large-5 medium-5 small-12">
      <div class="content__search search-box">

        <select id="component" ng-model="selectedChoice" name="dropdown" class="minimal"
          ng-change="selectComponent(selectedChoice);">
          <option value="All" name="All">All Components</option>
          <option ng-selected="{{$index}}" ng-repeat="component in fullSensorsInfo track by $index"
            value="{{component.Name}}">{{component.Name}}</option>
        </select>
      </div>
    </div>

    <div class="columns large-7  medium-7 small-12">
      <div class="content__search search-box">
        <label for="content__search-input">Sensors Search</label>
        <input id="content__search-input" type="text" ng-model="customSearch" ng-keydown="doSearchOnEnter($event)" />
        <div class="search-submit__wrapper">
          <button class="clear-input" ng-click="clear()">&#10005;</button>
          <input id="content__search-submit" type="submit" class="btn content__search-submit" value="Search"
            ng-click="doSearchOnClick()" />
        </div>
      </div>
    </div>
  </div>

  <section id="sensor-categories" class="page-content-rnd table row column"
    ng-hide="(filteredMergedSensors).length == 0">

    <div class="text-intro trim-text-small">
      <input type='checkbox' id="toggleThresholdVisibility" class="btn-primary" ng-click="toggle = !toggle;">
      {{toggleText}}
    </div>

    <div class="table row column sensor__table">
      <div class="table__head fixed-table-header">
        <div class="table__row">
          <div class="table__cell sensor__status-icon trim-text-small"></div>
          <div class="table__cell sensor__title" ng-click='sortColumn("Name")'>Sensor Name</div>
          <div class="table__cell sensor__status">Status</div>
          <div class="table__cell sensor__reading">Reading</div>
          <div class="table__cell sensor__threshold trim-text-small" ng-show="showThresholds">Low Critical</div>
          <div class="table__cell sensor__threshold trim-text-small" ng-show="showThresholds">Low Warning</div>
          <div class="table__cell sensor__threshold trim-text-small" ng-show="showThresholds">High Warning</div>
          <div class="table__cell sensor__threshold trim-text-small" ng-show="showThresholds">High Critical</div>
        </div>
      </div>
      <div class="table__body">
        <div class="table__row sensor-row__{{sensor.Status.Health}}"
          ng-repeat="sensor in (filteredMergedSensors = (mergedSensors | filter:filterByComponent | filter:filterBySearchTerms | filter:filterBySeverity | orderBy:orderSensorDataDefault | orderBy:column))">
          <div class="table__cell sensor__status-icon sensor__{{sensor.Status.Health}} trim-text-small">&nbsp;</div>
          <div class="table__cell sensor__title">{{sensor.Name}}</div>
          <div class="table__cell sensor__status">{{sensor.Status.Health}}</div>
          <div class="table__cell sensor__reading">
            {{(sensor.ReadingVolts | number:2)}} {{(sensor.ReadingVolts) ? " V" : ""}}
            {{((sensor.ReadingVolts | number:2)=="0.00") ? " V" : ""}}
            {{(sensor.ReadingCelsius) ? (sensor.ReadingCelsius | number:2) + "&deg;" + (sensor.ReadingUnits) + " C" : ""}}
            {{(sensor.Reading | number:2)}} {{(sensor.Reading) ? sensor.ReadingUnits.replace("Percent","%") : ""}}
            {{((sensor.Reading | number:2)=="0") ? " " + sensor.ReadingUnits.replace("Percent","%") : ""}}
          </div>

          <div class="table__cell sensor__threshold trim-text-small" ng-show="showThresholds">
            {{(sensor.LowerThresholdNonCritical | number:2)}}
            {{(sensor.LowerThresholdNonCritical && sensor.ReadingVolts) ? " V" : ""}}
            {{((sensor.ReadingVolts | number:2)=="0.00") ? " V" : ""}}
            {{(sensor.LowerThresholdNonCritical && sensor.ReadingCelsius) ? " &deg;" + (sensor.ReadingUnits) + " C" : ""}}
            {{(sensor.LowerThresholdNonCritical && sensor.Reading) ? " " + sensor.ReadingUnits.replace("Percent","%") : ""}}
            {{(sensor.LowerThresholdNonCritical) ? "" : "-"}} </div>

          <div class="table__cell sensor__threshold trim-text-small" ng-show="showThresholds">
            {{(sensor.LowerThresholdNonCritical | number:2)}}
            {{(sensor.LowerThresholdNonCritical && sensor.ReadingVolts) ? " V" : ""}}
            {{((sensor.ReadingVolts | number:2)=="0.00") ? " V" : ""}}
            {{(sensor.LowerThresholdNonCritical && sensor.ReadingCelsius) ? " &deg;" + (sensor.ReadingUnits) + " C" : ""}}
            {{(sensor.LowerThresholdNonCritical && sensor.Reading) ? " " + sensor.ReadingUnits.replace("Percent","%") : ""}}
            {{(sensor.LowerThresholdNonCritical) ? "" : "-"}}
          </div>

          <div class="table__cell sensor__threshold trim-text-small" ng-show="showThresholds">
            {{(sensor.UpperThresholdNonCritical | number:2)}}
            {{(sensor.UpperThresholdNonCritical && sensor.ReadingVolts) ? " V" : ""}}
            {{((sensor.ReadingVolts | number:2)=="0.00") ? " V" : ""}}
            {{(sensor.UpperThresholdNonCritical && sensor.ReadingCelsius) ? " &deg;" + (sensor.ReadingUnits) + " C" : ""}}
            {{(sensor.UpperThresholdNonCritical && sensor.Reading) ? " " + sensor.ReadingUnits.replace("Percent","%") : ""}}
            {{(sensor.UpperThresholdNonCritical) ? "" : "-"}}
          </div>

          <div class="table__cell sensor__threshold trim-text-small" ng-show="showThresholds">
            {{(sensor.UpperThresholdCritical | number:2)}}
            {{(sensor.UpperThresholdCritical && sensor.ReadingVolts) ? " V" : ""}}
            {{((sensor.ReadingVolts | number:2)=="0.00") ? " V" : ""}}
            {{(sensor.UpperThresholdCritical && sensor.ReadingCelsius) ? " &deg;" + (sensor.ReadingUnits) + " C" : ""}}
            {{(sensor.UpperThresholdCritical && sensor.Reading) ? " " + sensor.ReadingUnits.replace("Percent","%") : ""}}
            {{(sensor.UpperThresholdCritical) ? "" : "-"}}
          </div>
        </div>
      </div>
    </div>

    <div class="text-outro">
      <a ng-href="data:text/json;charset=utf-8,{{mergedsensorsexport}}" class="float-right"
        download="{{export_name}}">Export&nbsp;&nbsp;<img src="../../assets/icons/icon-export.png"></a>
    </div>
  </section>



  <section id="sensor-message" class="row column page-content-rnd padding"
    ng-show="(filteredMergedSensors.length) == 0">
    <span ng-if="selectedSeverity == 'all'">{{messages.NO_SENSOR_DATA}}</span>
    <span ng-if="selectedSeverity == 'critical'">{{messages.CRITICAL_NO_SENSOR_DATA}}</span>
    <span ng-if="selectedSeverity == 'warning'">{{messages.WARNING_NO_SENSOR_DATA}}</span>
    <span ng-if="selectedSeverity == 'ok'">{{messages.NORMAL_NO_SENSOR_DATA}}</span>
  </section>